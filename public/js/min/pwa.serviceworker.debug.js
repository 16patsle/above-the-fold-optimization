!function(o,l,e){var n,a,u,i=!1,c=!1,s=1e3,h={},f=function(){var e=new URL(location);(n=e.searchParams.get("path"))||(n="/");var t=e.searchParams.get("config");t||(t="abtfr-pwa-config.json"),a=n+t};o.addEventListener("install",function(e){e.waitUntil(y().then(function(){o.skipWaiting()}).catch(function(){o.skipWaiting()}))}),o.addEventListener("activate",function(e){o.clients.claim()}),CacheStorage.prototype.match||(CacheStorage.prototype.match=function(r,o){var a=this;return this.keys().then(function(e){var n;return e.reduce(function(e,t){return e.then(function(){return n||a.open(t).then(function(e){return e.match(r,o)}).then(function(e){return n=e})})},Promise.resolve())})});var d,r,p,v,w,m=function(){function c(){this.value=[],this.leftBits=0}function s(e,t){return e-t}c.prototype.addBit=function(e){return 0==this.leftBits&&(this.value.push(0),this.leftBits=8),--this.leftBits,e&&(this.value[this.value.length-1]|=1<<this.leftBits),this},c.prototype.addBits=function(e,t){if(0!=t)for(;--t,this.addBit(e&1<<t),0!=t;);return this},c.prototype.gcsEncode=function(e,t){for(var n=-1,r=0;r!=e.length;++r)if(n!=e[r]){for(var o=e[r]-n-1,a=o>>t;0!=a;--a)this.addBit(0);this.addBit(1),this.addBits(o,t),n=e[r]}return this};var f=new TextEncoder("utf-8");function n(n,r){if(r>=Math.pow(2,32))throw Error('Invalid probability: "${p}" must be smaller than 2**32');if(!(0<(e=r)&&(e&1+~e)===e))throw Error('Invalid probability: "${p}" must be a power of 2');var e,o,i=Math.min(Math.pow(2,Math.round(Math.log2(n.length))),Math.pow(2,31)),a=[];return new Promise(function(t,e){Promise.all(n.map(function(e){return n=e,o=i,a=r,new Promise(function(r,e){var t=n.replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)});crypto.subtle.digest("SHA-256",f.encode(t)).then(function(e){var t=new DataView(e).getUint32(0),n=Math.log2(o*a);if(31<n)throw Error("This implementation only supports up to 31 bit hash values");r(t=t>>32-n&(1<<n)-1)})});var n,o,a})).then(function(e){a=a.concat().sort(s),o=Uint8Array.from((new c).addBits(Math.log2(i),5).addBits(Math.log2(r),5).gcsEncode(a,Math.log2(r)).value),t(function(e){for(var t="",n=e.byteLength,r=0;r<n;r++)t+=String.fromCharCode(e[r]);return btoa(t).replace(/=+$/,"")}(o))})})}return function(e,t){return n(e,t)}}(),g=(d={},r=0,p=[],{start:function(e){var t=++r;return d[t]=[Date.now(),e],t},complete:function(e){try{delete d[e]}catch(e){}0<p.length&&v(null,0)},onIdle:v=function(e,t,n){var r=!1,o=Object.keys(d);if(0<o.length){var a=Date.now();o.forEach(function(e){if(!r)if(d[e][0]<a-d[e][1])try{delete d[e]}catch(e){}else r=!0})}if(r){if(0===t)return;var i;if(n){var c=!1;p.forEach(function(e,t){c||e[2]==n&&(c=t)}),c&&(p[c][1]&&clearTimeout(p[c][1]),i=c)}i||(i=p.push([])-1),p[i]=[e,setTimeout(function(e,t){delete p[e],t(),0<p.length&&v(null,0)},t,i,e),n]}else if(e&&p.push([e]),0<p.length)for(var s=p.shift();s;){if(s instanceof Array){s[1]&&clearTimeout(s[1]);try{s[0]()}catch(e){}}s=p.shift()}}}),b=function(o){return new Promise(function(e,t){if(!i||!c||o&&c<o){var n=!i;y().then(function(){n&&e(i||!1)}).catch(function(){n&&e(!1)})}else if(!w&&c<A()-300){f(),w=!0;var r=new Request(a+"?"+Math.round(Date.now()/1e3),{method:"HEAD",mode:"no-cors"});l(r).then(function(e){var t=!(w=!1);if(e&&e.ok){var n=x(e.headers.get("last-modified"));n&&n<=c&&(t=!1)}t&&y()}).catch(function(e){w=!1,y()})}else e(i)}).catch(function(e){setTimeout(function(){throw e})})},y=function(){return w?Promise.resolve():(f(),w=!0,l(a+"?"+Math.round(Date.now()/1e3),{mode:"no-cors"}).then(function(e){if(w=!1,e&&e.ok&&e.status<400)return e.json().then(function(e){if(console.info("Abtfr.sw() ➤ config "+(i?"updated":"loaded"),e),e){e instanceof Array&&(e={policy:e}),u="abtfr",e.cache_version&&(u=u+":"+e.cache_version),e.policy&&(i=e.policy,c=A());var t=[],n=[];return e.start_url&&n.push(B(e.start_url)),e.policy&&e.policy.forEach(function(e){e.offline&&-1===t.indexOf(e.offline)&&t.push(e.offline)}),e.preload&&e.preload.forEach(function(e){-1===t.indexOf(e)&&t.push(e)}),preloadPromises=[],t.forEach(function(e){preloadPromises.push(B(e))}),e.preload_install&&(n=n.concat(preloadPromises)),Promise.all(n)}});throw i=!1,new Error("service worker config not found: "+a)}).catch(function(e){i=w=!1,setTimeout(function(){throw e})}))},A=function(){return Math.round(Date.now()/1e3)},x=function(e){if(e)return isNaN(parseInt(e))?(e=Date.parse(e),isNaN(e)?void 0:Math.round(e/1e3)):e},E=/^\/(.*)\/([gimuy]+)?$/,q=function(e){var t=e.match(E);if(t){try{var n=new RegExp(t[1],t[2])}catch(e){}return n||!1}},t=!1,k=!1,T=!1,P=function(){k||(!t||t<A()-10)&&(k=!0,t=A(),caches.keys().then(function(e){return e&&0!==e.length?Promise.all(e.map(function(n){if(0!==n.indexOf(u))return console.info("Abtfr.sw() ➤ old cache deleted",n),caches.delete(n);caches.open(n).then(function(c){c.keys().then(function(e){if(console.info("Abtfr.sw() ➤ prune cache",n,"size:",e.length,s),!(e.length<s)){var a=[],i=[],t=[];return e.forEach(function(e){i.push(e),t.push(c.match(e))}),Promise.all(t).then(function(e){var o=A();(e.forEach(function(e,t){if(e&&e.headers){var n=e.headers.get("x-abtfr-sw");if(n){var r=e.headers.get("x-abtfr-sw-expire");if(r&&n&&n<A()-r)return console.info("Abtfr.sw() ➤ cache ➤ expired",e.url),void c.delete(i[t])}else n=o;!1!==a&&a.push({t:n,r:i[t]})}}),a&&a.length>s)&&(a.sort(function(e,t){return e.t>t.t?-1:e.t<t.t?1:0}),a.slice(s).forEach(function(e){c.delete(e.r)}))})}})})})).then(function(){k=!1}):Promise.resolve()}))},M=function(o,s,a,i){var e,f=g.start(1e3);return(e=o.headers.get("accept"),e&&e.includes("text/html")?new Promise(function(o,e){caches.open(u+":push").then(function(e){e.keys().then(function(e){if(0===e.length)return o(null);var t=[];e.forEach(function(e){t.push(I(e))}),Promise.all(t).then(function(n){var r=[];e.forEach(function(e,t){"undefined"!==n[t]&&n[t]&&r.push(e.url)}),0===r.length?o(null):m(r,Math.pow(2,7)).then(function(e){o(e)})})})})}):Promise.resolve(null)).then(function(e){var c=new Request(o);c.headers.set("x-pagespeed-sw",1),e&&c.headers.set("cache-digest",e);var t=c.url;if(!i&&h&&t in h&&h[t]&&h[t][0]>A()-5)return console.info("Abtfr.sw() ➤ hook into preload initiated request",t),h[t][1];var n=function(e){e in h&&(h[e]&&h[e][2]&&clearTimeout(h[e][2]),h[e]=!1,delete h[e])},r=l(c).then(function(a){n(t);var i=!1;if(a.ok&&a.status<400){var e=a.headers.get("link");e&&(e instanceof Array||(e=[e]),g.onIdle(function(){caches.open(u+":push").then(function(n){e.forEach(function(e){e.split(",").forEach(function(e){if(/rel=preload/.test(e)){var t=e.match(/<([^>]+)>/);t&&t[1]&&n.match(t[1]).then(function(e){e||n.put(t[1],new Response(null,{status:204}))})}})})})},1e3)),s&&(i=!0,s.conditions&&(s.conditions.forEach(function(e){if(i)switch(e.type){case"url":if(e.regex){if(n=q(e.pattern)){var t=n.test(c.url);e.not?t&&(i=!1):t||(i=!1)}else i=!1}else{t=-1!==c.url.indexOf(e.pattern);e.not?t&&(i=!1):t||(i=!1)}break;case"header":var n,r=a.headers.get(e.name);if(r)if(e.regex)if(n=q(e.pattern)){t=n.test(r);e.not?t&&(i=!1):t||(i=!1)}else i=!1;else if("object"==typeof e.pattern)if(e.pattern.operator){r=parseFloat(r);var o=parseFloat(e.pattern.value);if(isNaN(r)||isNaN(o))i=!1;else{switch(e.pattern.operator){case"<":t=r<o;break;case">":t=o<r;break;case"=":t=r===o;break;default:i=!1}i&&(e.not?t&&(i=!1):t||(i=!1))}}else i=!1;else-1===r.indexOf(e.pattern)&&(i=!1);else i=!1}}),i?console.info("Abtfr.sw() ➤ cache condition ➤ cache",c.url,s.conditions):console.info("Abtfr.sw() ➤ cache condition ➤ no cache",c.url,s.conditions)),i&&D(c,a.clone(),s).then(function(){g.complete(f)}))}return i||g.complete(f),a}).catch(function(e){return n(t),g.complete(f),a?a(c,null,e):null});return i&&(h[t]=[A(),r],h[t][2]=setTimeout(function(){h[t]=!1,delete h[t]},5e3)),r})},N=function(e,n){return e=new Request(e),I(e).then(function(t){return t?t.blob().then(function(e){return new Response(e,{status:503,statusText:"Offline",headers:t.headers})}):l(n).catch(function(e){setTimeout(function(){throw e})})})},I=function(o){var a=g.start(1e3);return caches.open(u).then(function(e){return e.match(o).then(function(e){if(e){var t=e.headers.get("x-abtfr-sw-expire");if(t)var n=e.headers.get("x-abtfr-sw");var r=e.headers.get("expire");r&&(r=x(r)),t&&n<A()-t?(e=!1,console.info("Abtfr.sw() ➤ cache expired by policy",o.url,"max age:",t)):r&&r<A()&&(e=!1,console.info("Abtfr.sw() ➤ cache expired by HTTP expire",o.url,e.headers.get("expire")))}return g.complete(a),e})})},B=function(n){if(n)return"string"==typeof n&&(n=new Request(n,{mode:"no-cors"})),I(n).then(function(e){if(!e){var t=n.url;return console.info("Abtfr.sw() ➤ preload",t),M(n,{conditions:null},!1,!0)}return e})},D=function(o,a,e){return caches.open(u).then(function(n){var r={};return a.headers.forEach(function(e,t){r[t]=e}),r["x-abtfr-sw"]=A(),e&&e.max_age&&(r["x-abtfr-sw-expire"]=e.max_age),a.blob().then(function(e){var t=new Response(e,{status:a.status,statusText:a.statusText,headers:r});return n.put(o,t)})})};o.addEventListener("fetch",function(n){if("GET"===n.request.method){var r=!1;if(["wp-admin/","wp-login.php"].forEach(function(e){if(!r){var t=new RegExp("^([^/]+)?//"+o.location.host+"(:[0-9]+)?/"+e);(t.test(n.request.url)||n.request.referrer&&t.test(n.request.referrer))&&(r=!0)}}),!(r||n.request.url.match(/\&preview=true/)||n.request.url.match(/\&preview_nonce=/))&&(b(),i&&u)){var e=function(i,e){if(!e||0===e.length)return!1;var c=!1;if(e.forEach(function(e){if(!c&&e.match&&0!==e.match.length){var a=!0;e.match.forEach(function(e){if(a)switch(e.type){case"url":if(e.regex)if(o=q(e.pattern)){var t=o.test(i.request.url);e.not?t&&(a=!1):t||(a=!1)}else a=!1;else if(e.pattern instanceof Array){var n=!1;e.pattern.forEach(function(e){n||-1!==i.request.url.indexOf(e)&&(n=!0)}),e.not?n&&(a=!1):n||(a=!1)}else t=-1!==i.request.url.indexOf(e.pattern),e.not?t&&(a=!1):t||(a=!1);break;case"header":switch(e.name.toLowerCase()){case"referer":case"referrer":var r=i.request.referrer;break;default:r=i.request.headers.get(e.name)}if(r)if(e.regex){var o;(o=q(e.pattern))?(t=o.test(r),e.not?t&&(a=!1):t||(a=!1)):a=!1}else t=-1!==r.indexOf(e.pattern),e.not?t&&(a=!1):t||(a=!1);else e.not||(a=!1)}}),a&&(c=e)}}),!c)return console.info("Abtfr.sw() ➤ policy ➤ no match",i.request.url),!1;switch(console.info("Abtfr.sw() ➤ policy ➤ match",i.request.url,c),T&&clearTimeout(T),T=setTimeout(function(){g.onIdle(P,1e4,"clean-cache"),T=!1},100),c.strategy){case"never":return!1;case"cache":return I(i.request).then(function(e){if(e){var t=!0;if(c.cache.update_interval)var n=!isNaN(parseInt(c.cache.update_interval))&&parseInt(c.cache.update_interval);else n=!1;if(n){var r=e.headers.get("x-abtfr-sw");r&&parseInt(r)>A()-n&&(t=!1)}return t&&(o=i.request.clone(),a=e.clone(),setTimeout(function(){var e;if(c.cache.notify&&(e=function(){clients.matchAll().then(function(e){e.forEach(function(e){e.postMessage([2,o.url])})})}),c.cache.head_update)console.info("Abtfr.sw() ➤ HEAD ➤ verify",o.url),function(a,i,e,c){var s=e.headers.get("etag"),f=x(e.headers.get("last-modified"));if(!s&&!f){console.warn("Abtfr.sw() ➤ HEAD ➤ no etag or last-modified",a.url);var t=M(a,i);return c&&(t=t.then(c))}var u=g.start(1e3),n=new Request(a.url,{method:"HEAD",headers:a.headers,mode:"no-cors"});l(n).then(function(e){var t=!1,n=e.headers.get("etag"),r=x(e.headers.get("last-modified"));if(n&&n!==s?t=!0:r&&r!==f&&(t=!0),t){console.info("Abtfr.sw() ➤ HEAD ➤ update",a.url);var o=M(a,i);return o=o.then(function(e){return g.complete(u),e}),c&&(o=o.then(c)),o}return g.complete(u),null}).catch(function(e){var t=M(a,i);return t=t.then(function(e){return g.complete(u),e}),c&&(t=t.then(c)),t})}(o,c.cache,a,e);else{console.info("Abtfr.sw() ➤ update cache",o.url);var t=M(o,c.cache);e&&t.then(e)}},10)),console.info("Abtfr.sw() ➤ from cache",i.request.url),e}return M(i.request,c.cache,function(e,t,n){return c.offline?(console.warn("Abtfr.sw() ➤ no cache ➤ network failed ➤ offline page",e.url),N(c.offline,e.clone())):(console.warn("Abtfr.sw() ➤ no cache ➤ network failed ➤ empty 404 response",e.url,t,n),t||l(i.request.clone()).catch(function(e){setTimeout(function(){throw e})}))});var o,a});case"event":return I(i.request).then(function(e){return e?(console.info("Abtfr.sw() ➤ from cache",i.request.url),e):M(i.request,null,function(e,t,n){return c.offline?(console.warn("Abtfr.sw() ➤ no cache ➤ network failed ➤ offline page",e.url),N(c.offline,e.clone())):(console.warn("Abtfr.sw() ➤ no cache ➤ network failed ➤ empty 404 response",e.url,t),t||l(i.request).catch(function(e){setTimeout(function(){throw e})}))})});case"network":default:return M(i.request,c.cache,function(t,n,e){return console.warn("Abtfr.sw() ➤ network failed",t.url,n||e),I(t).then(function(e){return e?(console.info("Abtfr.sw() ➤ fallback from cache",t.url),e):c.offline?(console.warn("Abtfr.sw() ➤ no cache ➤ offline page",t.url),N(c.offline,t.clone())):(console.warn("Abtfr.sw() ➤ no cache ➤ empty 404 response",t.url),n||l(i.request).catch(function(e){setTimeout(function(){throw e})}))})})}}(n,i);if(!1!==e)return n.respondWith(e)}}}),o.addEventListener("message",function(n){if(n&&n.data&&n.data instanceof Array){if(1===n.data[0]&&(n.data[1]&&!isNaN(parseInt(n.data[1]))&&b(parseInt(n.data[1])),n.data[3]&&!isNaN(parseInt(n.data[3]))&&(s=parseInt(n.data[3])),g.onIdle(P,1e4,"clean-cache")),2===n.data[0]||3===n.data[0])if(n.ports[0])var t=function(e,t){n.ports[0].postMessage({error:e,status:t})};else t=!1;var e;if(2===n.data[0])if(n.data[1])if("string"==typeof n.data[1]||n.data[1]instanceof Request?e=[n.data[1]]:n.data[1]instanceof Array&&(e=n.data[1]),e){var r=[];e.forEach(function(e){r.push(B(e))}),t&&Promise.all(r).then(function(e){var r=[];e.forEach(function(e){var t={url:e.url,status:e.status,statusText:e.statusText},n=e.headers.get("content-length");t.size=isNaN(parseInt(n))?-1:parseInt(n),r.push(t)}),t(null,r)}).catch(function(e){console.error("Abtfr.sw() ➤ preload",e)})}else t&&t("invalid-data");else t&&t("no-urls");3===n.data[0]&&(o.registration.showNotification(n.data[1],n.data[2]),t&&t(null,"sent"))}})}(self,self.fetch,Cache);