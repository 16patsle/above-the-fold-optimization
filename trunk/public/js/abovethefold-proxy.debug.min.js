Abtf[0](function(M,e){function A(a){var b=L(a);if(b){var c;a:{c=m("css"===b?a.href:a.src).href;var g,q=!1;if(B){var d=C.indexOf(c);if(-1<d)var h=D[d];else if(0<n.length)for(var k,l=n.length,f=0;f<l;f++){d=!1;try{k=new RegExp(n[f][0],n[f][1]||"")}catch(N){d=!0}if(!d&&k.test(c)){q=!0;g=c;n[f][2]?h=n[f][2]:n[f][3]&&(c=n[f][3]);break}}if(h){var p;k=E;void 0!==v[c]?p=v[c]:w&&(p=w);p&&(k=k.replace(/^http(s)?:\/\/[^\/]+\//,p));k+=h.substr(0,2)+"/";k+=h.substr(2,2)+"/";k+=h.substr(4,2)+"/";k+=h;p=!1;if("js"===
b){if(k+=".js",void 0!==e[24])d=m(k).href,(k=e[24](d))!==d&&(p=k)}else"css"===b&&(k+=".css");c=(p?q?console.log("Abtf.proxy()","localStorage regex capture",e[29](g),"\u27a4","cache:"+h,"\u27a4",p):console.log("Abtf.proxy()","localStorage capture",e[29](c),"\u27a4","cache:"+h,"\u27a4",p):q?console.log("Abtf.proxy()","regex capture",e[29](g),"\u27a4","cache:"+h):console.log("Abtf.proxy()","capture",e[29](c),"\u27a4","cache:"+h),k);break a}}if("js"===b&&void 0!==e[24]&&(h=m(c).href,(c=e[24](h))!==h)){c=
(q?console.log("Abtf.proxy()","localStorage regex capture",e[29](g),"regex","\u27a4",e[29](h),"\u27a4",c):console.log("Abtf.proxy()","localStorage capture",e[29](h),"\u27a4",c),c);break a}c=(q?console.log("Abtf.proxy()","capture",e[29](g),"regex","\u27a4",c):console.log("Abtf.proxy()","capture",e[29](c)),F(c,b))}"css"===b?a.href=c:"js"===b&&(a.src=c)}}function L(a){if(a.nodeName)if("SCRIPT"===a.nodeName.toUpperCase()){if(!G||a.hasAttribute("data-abtf"))return!1;if(a.src){if(function(a){a="object"==
typeof a&&void 0!==a.href?a:m(a);if("blob:"===a.protocol)return!0;if(r){console.log(222,r);for(var b=!1,c=r.length,d=0;d<c;d++)if(-1!==a.href.indexOf(r[d])){b=!0;break}if(!b)return console.log("Abtf.proxy()","ignore",e[29](a.href),"not on include list"),!0}if(t)for(c=t.length,d=0;d<c;d++)if(-1!==a.href.indexOf(t[d]))return console.log("Abtf.proxy()","ignore",e[29](a.href),"on exclude list:",t[d]),!0;return!1}(b=m(a.src)))return!1;if(!H(b)){if(void 0!==e[24]){if("blob:"===b.protocol)return!1;url=e[24](b.href);
url!==b.href?(console.log("Abtf.proxy()","localStorage local capture",e[29](b.href),"\u27a4",url),a.src=url):console.log("Abtf.proxy()","localStorage local capture",e[29](b.href),"\u27a4","bypass cache","\u27a4",url)}return!1}return"js"}}else if("LINK"===a.nodeName.toUpperCase()&&"stylesheet"===a.rel.toLowerCase()){if(!I||a.hasAttribute("data-abtf"))return!1;var b;if(a.href)return!function(a){a="object"==typeof a&&void 0!==a.href?a:m(a);if("blob:"===a.protocol)return!0;if(x){for(var b=!1,c=x.length,
d=0;d<c;d++)if(-1!==a.href.indexOf(x[d])){b=!0;break}if(!b)return console.log("Abtf.proxy()","ignore",e[29](a.href),"not on include list"),!0}if(u)for(c=u.length,d=0;d<c;d++)if(-1!==a.href.indexOf(u[d]))return console.log("Abtf.proxy()","ignore",e[29](a.href),"on exclude list:",u[d]),!0;return!1}(b=m(a.href))&&!!function(a){a="object"==typeof a&&void 0!==a.href?a:m(a);if("blob:"===a.protocol)return!1;if(g)for(var b=g.length,c=0;c<b;c++)if(-1!==a.href.indexOf(g[c].href))return!1;return a.host!==y.host}(b)&&
"css"}return!1}function H(a,b){var c="object"==typeof a&&void 0!==a.href?a:m(a);if("blob:"===c.protocol)return!1;if(g&&!0!==b)for(var e=g.length,f=0;f<e;f++)if(-1!==c.href.indexOf(g[f].href))return!1;return c.host!==y.host}function F(a,b){return"css"===b?z.replace("{PROXY:URL}",escape(a)).replace("{PROXY:TYPE}",escape(b)):"js"===b?z.replace("{PROXY:URL}",escape(a)).replace("{PROXY:TYPE}",escape(b)):void 0}function m(a){var b=document.createElement("a");return b.href=a,b}var z,E,G=!1,I=!1,w=!1,r=!1,
t=!1,x=!1,u=!1,B=!1,C=[],D=[],n=[],v={},g=[];e[27]=function(a){if(void 0===b)var b=!1;if((z=a[0]&&-1!==a[0]?a[0]:b)||console.error("Abtf.proxy()","no proxy url",a),G=!(!a[1]||-1===a[1])&&a[1],I=!(!a[2]||-1===a[2])&&a[2],(w=!(!a[9]||-1===a[9])&&a[9])&&g.push(w),r=!(!a[5]||-1===a[5])&&a[5],t=!(!a[6]||-1===a[6])&&a[6],x=!(!a[7]||-1===a[7])&&a[7],u=!(!a[8]||-1===a[8])&&a[8],a[3]){B=!0;for(b=0;b<a[3].length;b++)"regex"===a[3][b][0]?(n.push([a[3][b][2],a[3][b][3],a[3][b][1]]),a[3][b][4]&&(v[a[3][b][0]]=
a[3][b][4],-1===g.indexOf(a[3][b][4])&&g.push(a[3][b][4]))):(C.push(a[3][b][0]),D.push(a[3][b][1]),a[3][b][4]&&(v[a[3][b][0]]=a[3][b][4],-1===g.indexOf(a[3][b][4])&&g.push(a[3][b][4])));E=!(!a[4]||-1===a[4])&&a[4]}if(0===g.length)g=!1;else for(a=g.length,b=0;b<a;b++)g[b]=m(g[b])};var f={Element:"undefined"!=typeof Element&&Element,Document:"undefined"!=typeof Document&&Document},J={},K={},l;for(l in f)f.hasOwnProperty(l)&&f[l]&&(J[l]=f[l].prototype.appendChild,K[l]=f[l].prototype.insertBefore);var y=
document.createElement("a");y.href=document.location.href;for(l in f)f.hasOwnProperty(l)&&f[l]&&function(a){f[a].prototype.appendChild=function(b){return A(b),J[a].call(this,b)};f[a].prototype.insertBefore=function(b,c){return A(b),K[a].call(this,b,c)}}(l);e[28]=function(a){return H(a,!0)?F(a,"js"):a}});
