!function(a,b){var c,d,e=!1,f=!1,g=!1,h=!1,i=!1,j=!1,k=!1,l=[],m=[],n=[];a.Abtf.proxy_setup=function(a){if("undefined"==typeof b)var b=!1;if(c=a.url||b,c||console.error("Abtf.proxy()","no proxy url",a),e=a.js||!1,f=a.css||!1,g=a.js_include||!1,h=a.js_exclude||!1,i=a.css_include||!1,j=a.css_exclude||!1,a.preload){k=!0;for(var o=0;o<a.preload.length;o++)"regex"===a.preload[o][0]?n.push([a.preload[o][2],a.preload[o][3],a.preload[o][1],a.preload[o][4]]):(l.push(a.preload[o][0]),m.push(a.preload[o][1]));d=a.base||!1}};var o={Element:"undefined"!=typeof Element&&Element,Document:"undefined"!=typeof Document&&Document},p={append:{},insert:{}};for(var q in o)o.hasOwnProperty(q)&&o[q]&&(p.append[q]=o[q].prototype.appendChild,p.insert[q]=o[q].prototype.insertBefore);var r=document.createElement("a");r.href=document.location.href;var s=function(a){var b=document.createElement("a");return b.href=a,b},t=function(a,b){var e,f=!1;if(k){var g=l.indexOf(a);if(g>-1)var h=m[g];else if(n.length>0)for(var i,j,o=n.length,p=0;p<o;p++){j=!1;try{i=new RegExp(n[p][0],n[p][1]||"")}catch(a){j=!0}if(!j&&i.test(a)){f=!0,e=a,n[p][2]?h=n[p][2]:n[p][3]&&(a=n[p][3]);break}}if(h){var q=d;return q+=h.substr(0,2)+"/",q+=h.substr(2,2)+"/",q+=h.substr(4,2)+"/",q+=h.substr(6,2)+"/",q+=h.substr(8,2)+"/",q+=h,"js"===b?q+=".js":"css"===b&&(q+=".css"),f?console.log("Abtf.proxy()","capture",e,"regex","➤","cache:"+h):console.log("Abtf.proxy()","capture",a,"➤","cache:"+h),q}}return f?console.log("Abtf.proxy()","capture",e,"regex","➤",a):console.log("Abtf.proxy()","capture",a),"css"===b?c.replace("{PROXY:URL}",escape(a)).replace("{PROXY:TYPE}",escape(b)):"js"===b?c.replace("{PROXY:URL}",escape(a)).replace("{PROXY:TYPE}",escape(b)):void 0},u=function(a){if(a.nodeName)if("SCRIPT"===a.nodeName.toUpperCase()){if(!e)return!1;if(a.src){var b=s(a.src);if(b.host===r.host)return!1;if(g){for(var c=!1,d=g.length,k=0;k<d;k++)if(b.href.indexOf(g[k])!==-1){c=!0;break}if(!c)return!1}if(h)for(var d=h.length,k=0;k<d;k++)if(b.href.indexOf(h[k])!==-1)return!1;return"js"}}else if("LINK"===a.nodeName.toUpperCase()&&"stylesheet"===a.rel.toLowerCase()){if(!f)return!1;if(a.href){var b=s(a.href);if(b.host===r.host)return!1;if(i){for(var c=!1,d=i.length,k=0;k<d;k++)if(b.href.indexOf(i[k])!==-1){c=!0;break}if(!c)return!1}if(j)for(var d=j.length,k=0;k<d;k++)if(b.href.indexOf(j[k])!==-1)return!1;return"css"}}return!1},v=function(a){var b=u(a);if(!b)return!1;var c=s("css"===b?a.href:a.src).href,d=t(c,b);"css"===b?a.href=d:"js"===b&&(a.src=d)},w={appendChild:function(a,b){return v(b),p.append[a].call(this,b)},insertBefore:function(a,b,c){return v(b),p.insert[a].call(this,b,c)}};for(var q in o)o.hasOwnProperty(q)&&o[q]&&!function(a){o[a].prototype.appendChild=function(b){return w.appendChild.call(this,a,b)},o[a].prototype.insertBefore=function(b,c){return w.insertBefore.call(this,a,b,c)}}(q)}(window,window.Abtf);