!function(e,t,n){var r,a,o,i=!1,c=!1,u=1e3,s={},f=function(){var e=new URL(location);(r=e.searchParams.get("path"))||(r="/");var t=e.searchParams.get("config");t||(t="abtf-pwa-config.json"),a=r+t};e.addEventListener("install",function(t){t.waitUntil(y().then(function(){e.skipWaiting()}).catch(function(){e.skipWaiting()}))}),e.addEventListener("activate",function(t){e.clients.claim()}),CacheStorage.prototype.match||(CacheStorage.prototype.match=function(e,t){var n=this;return this.keys().then(function(r){var a;return r.reduce(function(r,o){return r.then(function(){return a||n.open(o).then(function(n){return n.match(e,t)}).then(function(e){return a=e})})},Promise.resolve())})});var h,l,d,p,v,m=function(){function e(){this.value=[],this.leftBits=0}function t(e,t){return e-t}e.prototype.addBit=function(e){return 0==this.leftBits&&(this.value.push(0),this.leftBits=8),--this.leftBits,e&&(this.value[this.value.length-1]|=1<<this.leftBits),this},e.prototype.addBits=function(e,t){if(0!=t)do{--t,this.addBit(e&1<<t)}while(0!=t);return this},e.prototype.gcsEncode=function(e,t){for(var n=-1,r=0;r!=e.length;++r)if(n!=e[r]){for(var a=e[r]-n-1,o=a>>t;0!=o;--o)this.addBit(0);this.addBit(1),this.addBits(a,t),n=e[r]}return this};var n=new TextEncoder("utf-8");function r(r,a){if(a>=Math.pow(2,32))throw Error('Invalid probability: "${p}" must be smaller than 2**32');if(!((o=a)>0&&(o&1+~o)===o))throw Error('Invalid probability: "${p}" must be a power of 2');var o,i,c=Math.min(Math.pow(2,Math.round(Math.log2(r.length))),Math.pow(2,31)),u=[];return new Promise(function(o,s){Promise.all(r.map(function(e){return t=e,r=c,o=a,new Promise(function(e,a){var i=t.replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)});crypto.subtle.digest("SHA-256",n.encode(i)).then(function(t){var n=new DataView(t).getUint32(0),a=Math.log2(r*o);if(a>31)throw Error("This implementation only supports up to 31 bit hash values");e(n=n>>32-a&(1<<a)-1)})});var t,r,o})).then(function(n){u=u.concat().sort(t),i=Uint8Array.from((new e).addBits(Math.log2(c),5).addBits(Math.log2(a),5).gcsEncode(u,Math.log2(a)).value),o(function(e){for(var t="",n=e.byteLength,r=0;r<n;r++)t+=String.fromCharCode(e[r]);return btoa(t).replace(/=+$/,"")}(i))})})}return function(e,t){return r(e,t)}}(),g=(h={},l=0,d=[],{start:function(e){var t=++l;return h[t]=[Date.now(),e],t},complete:function(e){try{delete h[e]}catch(e){}d.length>0&&p(null,0)},onIdle:p=function(e,t,n){var r=!1,a=Object.keys(h);if(a.length>0){var o=Date.now();a.forEach(function(e){if(!r)if(h[e][0]<o-h[e][1])try{delete h[e]}catch(e){}else r=!0})}if(r){if(0===t)return;var i;if(n){var c=!1;d.forEach(function(e,t){c||e[2]==n&&(c=t)}),c&&(d[c][1]&&clearTimeout(d[c][1]),i=c)}i||(i=d.push([])-1),d[i]=[e,setTimeout(function(e,t){delete d[e],t(),d.length>0&&p(null,0)},t,i,e),n]}else if(e&&d.push([e]),d.length>0)for(var u=d.shift();u;){if(u instanceof Array){u[1]&&clearTimeout(u[1]);try{u[0]()}catch(e){}}u=d.shift()}}}),w=function(e){return new Promise(function(n,r){if(!i||!c||e&&e>c){var o=!i;y().then(function(){o&&n(i||!1)}).catch(function(){o&&n(!1)})}else if(!v&&c<E()-300){f(),v=!0;var u=new Request(a+"?"+Math.round(Date.now()/1e3),{method:"HEAD",mode:"no-cors"});t(u).then(function(e){v=!1;var t=!0;if(e&&e.ok){var n=x(e.headers.get("last-modified"));n&&n<=c&&(t=!1)}t&&y()}).catch(function(e){v=!1,y()})}else n(i)}).catch(function(e){setTimeout(function(){throw e})})},y=function(){return v?Promise.resolve():(f(),v=!0,t(a+"?"+Math.round(Date.now()/1e3),{mode:"no-cors"}).then(function(e){if(v=!1,e&&e.ok&&e.status<400)return e.json().then(function(e){if(e){e instanceof Array&&(e={policy:e}),o="abtf",e.cache_version&&(o=o+":"+e.cache_version),e.policy&&(i=e.policy,c=E());var t=[],n=[];return e.start_url&&n.push(A(e.start_url)),e.policy&&e.policy.forEach(function(e){e.offline&&-1===t.indexOf(e.offline)&&t.push(e.offline)}),e.preload&&e.preload.forEach(function(e){-1===t.indexOf(e)&&t.push(e)}),preloadPromises=[],t.forEach(function(e){preloadPromises.push(A(e))}),Promise.all(n)}});throw i=!1,new Error("service worker config not found: "+a)}).catch(function(e){v=!1,i=!1,setTimeout(function(){throw e})}))},E=function(){return Math.round(Date.now()/1e3)},x=function(e){if(e)return isNaN(parseInt(e))?(e=Date.parse(e),isNaN(e)?void 0:Math.round(e/1e3)):e},b=/^\/(.*)\/([gimuy]+)?$/,q=function(e){var t=e.match(b);if(t){try{var n=new RegExp(t[1],t[2])}catch(e){}return n||!1}},T=!1,k=!1,P=!1,M=function(){k||(!T||T<E()-10)&&(k=!0,T=E(),caches.keys().then(function(e){return e&&0!==e.length?Promise.all(e.map(function(e){if(0!==e.indexOf(o))return caches.delete(e);caches.open(e).then(function(e){e.keys().then(function(t){if(!(t.length<u)){var n=[],r=[],a=[];return t.forEach(function(t){r.push(t),a.push(e.match(t))}),Promise.all(a).then(function(t){var a=E();(t.forEach(function(t,o){if(t&&t.headers){var i=t.headers.get("x-abtf-sw");if(i){var c=t.headers.get("x-abtf-sw-expire");if(c&&i&&i<E()-c)return void e.delete(r[o])}else i=a;!1!==n&&n.push({t:i,r:r[o]})}}),n&&n.length>u)&&(n.sort(function(e,t){return e.t>t.t?-1:e.t<t.t?1:0}),n.slice(u).forEach(function(t){e.delete(t.r)}))})}})})})).then(function(){k=!1}):Promise.resolve()}))},N=function(e,n,r,a){var i,c=g.start(1e3);return(i=e.headers.get("accept"),i&&i.includes("text/html")?new Promise(function(e,t){caches.open(o+":push").then(function(t){t.keys().then(function(t){if(0===t.length)return e(null);var n=[];t.forEach(function(e){n.push(B(e))}),Promise.all(n).then(function(n){var r=[];t.forEach(function(e,t){"undefined"!==n[t]&&n[t]&&r.push(e.url)}),0===r.length?e(null):m(r,Math.pow(2,7)).then(function(t){e(t)})})})})}):Promise.resolve(null)).then(function(i){var u=e;i&&(u=new Request(u)).headers.set("cache-digest",i);var f=u.url;if(!a&&s&&f in s&&s[f]&&s[f][0]>E()-5)return s[f][1];var h=function(e){e in s&&(s[e]&&s[e][2]&&clearTimeout(s[e][2]),s[e]=!1,delete s[e])},l=t(u).then(function(e){h(f);var t=!1;if(e.ok&&e.status<400){var r=e.headers.get("link");r&&(r instanceof Array||(r=[r]),g.onIdle(function(){caches.open(o+":push").then(function(e){r.forEach(function(t){t.split(",").forEach(function(t){if(/rel=preload/.test(t)){var n=t.match(/<([^>]+)>/);n&&n[1]&&e.match(n[1]).then(function(t){t||e.put(n[1],new Response(null,{status:204}))})}})})})},1e3)),n&&(t=!0,n.conditions&&n.conditions.forEach(function(n){if(t)switch(n.type){case"url":if(n.regex){if(a=q(n.pattern)){var r=a.test(u.url);n.not?r&&(t=!1):r||(t=!1)}else t=!1}else{r=-1!==u.url.indexOf(n.pattern);n.not?r&&(t=!1):r||(t=!1)}break;case"header":var a,o=e.headers.get(n.name);if(o)if(n.regex)if(a=q(n.pattern)){r=a.test(o);n.not?r&&(t=!1):r||(t=!1)}else t=!1;else if("object"==typeof n.pattern)if(n.pattern.operator){o=parseFloat(o);var i=parseFloat(n.pattern.value);if(isNaN(o)||isNaN(i))t=!1;else{switch(n.pattern.operator){case"<":r=o<i;break;case">":r=o>i;break;case"=":r=o===i;break;default:t=!1}t&&(n.not?r&&(t=!1):r||(t=!1))}}else t=!1;else-1===o.indexOf(n.pattern)&&(t=!1);else t=!1}}),t&&R(u,e.clone(),n).then(function(){g.complete(c)}))}return t||g.complete(c),e}).catch(function(e){return h(f),g.complete(c),r?r(u,null,e):null});return a&&(s[f]=[E(),l],s[f][2]=setTimeout(function(){s[f]=!1,delete s[f]},5e3)),l})},I=function(e,n){return e=new Request(e),B(e).then(function(e){return e?e.blob().then(function(t){return new Response(t,{status:503,statusText:"Offline",headers:e.headers})}):t(n).catch(function(e){setTimeout(function(){throw e})})})},B=function(e){var t=g.start(1e3);return caches.open(o).then(function(n){return n.match(e).then(function(e){if(e){var n=e.headers.get("x-abtf-sw-expire");if(n)var r=e.headers.get("x-abtf-sw");var a=e.headers.get("expire");a&&(a=x(a)),n&&r<E()-n?e=!1:a&&a<E()&&(e=!1)}return g.complete(t),e})})},A=function(e){if(e)return"string"==typeof e&&(e=new Request(e,{mode:"no-cors"})),B(e).then(function(t){if(!t){e.url;return N(e,{conditions:null},!1,!0)}return t})},R=function(e,t,n){return caches.open(o).then(function(r){var a={};return t.headers.forEach(function(e,t){a[t]=e}),a["x-abtf-sw"]=E(),n&&n.max_age&&(a["x-abtf-sw-expire"]=n.max_age),t.blob().then(function(n){var o=new Response(n,{status:t.status,statusText:t.statusText,headers:a});return r.put(e,o)})})};e.addEventListener("fetch",function(n){if("GET"===n.request.method){var r=!1;if(["wp-admin/","wp-login.php"].forEach(function(t){if(!r){var a=new RegExp("^([^/]+)?//"+e.location.host+"(:[0-9]+)?/"+t);(a.test(n.request.url)||n.request.referrer&&a.test(n.request.referrer))&&(r=!0)}}),!(r||n.request.url.match(/\&preview=true/)||n.request.url.match(/\&preview_nonce=/))&&(w(),i&&o)){var a=function(e,n){if(!n||0===n.length)return!1;var r=!1;if(n.forEach(function(t){if(!r&&t.match&&0!==t.match.length){var n=!0;t.match.forEach(function(t){if(n)switch(t.type){case"url":if(t.regex)if(i=q(t.pattern)){var r=i.test(e.request.url);t.not?r&&(n=!1):r||(n=!1)}else n=!1;else if(t.pattern instanceof Array){var a=!1;t.pattern.forEach(function(t){a||-1!==e.request.url.indexOf(t)&&(a=!0)}),t.not?a&&(n=!1):a||(n=!1)}else r=-1!==e.request.url.indexOf(t.pattern),t.not?r&&(n=!1):r||(n=!1);break;case"header":switch(t.name.toLowerCase()){case"referer":case"referrer":var o=e.request.referrer;break;default:o=e.request.headers.get(t.name)}if(o)if(t.regex){var i;(i=q(t.pattern))?(r=i.test(o),t.not?r&&(n=!1):r||(n=!1)):n=!1}else r=-1!==o.indexOf(t.pattern),t.not?r&&(n=!1):r||(n=!1);else t.not||(n=!1)}}),n&&(r=t)}}),!r)return!1;switch(P&&clearTimeout(P),P=setTimeout(function(){g.onIdle(M,1e4,"clean-cache"),P=!1},100),r.strategy){case"never":return!1;case"cache":return B(e.request).then(function(n){if(n){var a=!0;if(r.cache.update_interval)var o=!isNaN(parseInt(r.cache.update_interval))&&parseInt(r.cache.update_interval);else o=!1;if(o){var i=n.headers.get("x-abtf-sw");i&&parseInt(i)>E()-o&&(a=!1)}return a&&(c=e.request.clone(),u=n.clone(),setTimeout(function(){var e;if(r.cache.notify&&(e=function(){clients.matchAll().then(function(e){e.forEach(function(e){e.postMessage([2,c.url])})})}),r.cache.head_update)!function(e,n,r,a){var o=r.headers.get("etag"),i=x(r.headers.get("last-modified"));if(!o&&!i){var c=N(e,n);return a&&(c=c.then(a)),c}var u=g.start(1e3),s=new Request(e.url,{method:"HEAD",headers:e.headers,mode:"no-cors"});t(s).then(function(t){var r=!1,c=t.headers.get("etag"),s=x(t.headers.get("last-modified"));if(c&&c!==o?r=!0:s&&s!==i&&(r=!0),r){var f=N(e,n);return f=f.then(function(e){return g.complete(u),e}),a&&(f=f.then(a)),f}return g.complete(u),null}).catch(function(t){var r=N(e,n);return r=r.then(function(e){return g.complete(u),e}),a&&(r=r.then(a)),r})}(c,r.cache,u,e);else{var n=N(c,r.cache);e&&n.then(e)}},10)),n}return N(e.request,r.cache,function(n,a,o){return r.offline?I(r.offline,n.clone()):a||t(e.request.clone()).catch(function(e){setTimeout(function(){throw e})})});var c,u});case"event":return B(e.request).then(function(n){return n||N(e.request,null,function(n,a,o){return r.offline?I(r.offline,n.clone()):a||t(e.request).catch(function(e){setTimeout(function(){throw e})})})});case"network":default:return N(e.request,r.cache,function(n,a,o){return B(n).then(function(o){return o||(r.offline?I(r.offline,n.clone()):a||t(e.request).catch(function(e){setTimeout(function(){throw e})}))})})}}(n,i);if(!1!==a)return n.respondWith(a)}}}),e.addEventListener("message",function(t){if(t&&t.data&&t.data instanceof Array){if(1===t.data[0]&&(t.data[1]&&!isNaN(parseInt(t.data[1]))&&w(parseInt(t.data[1])),t.data[3]&&!isNaN(parseInt(t.data[3]))&&(u=parseInt(t.data[3])),g.onIdle(M,1e4,"clean-cache")),2===t.data[0]||3===t.data[0])if(t.ports[0])var n=function(e,n){t.ports[0].postMessage({error:e,status:n})};else n=!1;var r;if(2===t.data[0])if(t.data[1])if("string"==typeof t.data[1]||t.data[1]instanceof Request?r=[t.data[1]]:t.data[1]instanceof Array&&(r=t.data[1]),r){var a=[];r.forEach(function(e){a.push(A(e))}),n&&Promise.all(a).then(function(e){var t=[];e.forEach(function(e){var n={url:e.url,status:e.status,statusText:e.statusText},r=e.headers.get("content-length");n.size=isNaN(parseInt(r))?-1:parseInt(r),t.push(n)}),n(null,t)}).catch(function(e){0})}else n&&n("invalid-data");else n&&n("no-urls");3===t.data[0]&&(e.registration.showNotification(t.data[1],t.data[2]),n&&n(null,"sent"))}})}(self,self.fetch,Cache);