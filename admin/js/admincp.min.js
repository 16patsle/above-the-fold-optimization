!function(e,u){var a,t=e.jQuery||e.Cowboy||(e.Cowboy={});t.throttle=a=function(n,r,o,s){var c,l=0;function e(){var e=this,t=+new Date-l,i=arguments;function a(){l=+new Date,o.apply(e,i)}s&&!c&&a(),c&&clearTimeout(c),s===u&&n<t?a():!0!==r&&(c=setTimeout(s?function(){c=u}:a,s===u?n-t:n))}return"boolean"!=typeof r&&(s=o,o=r,r=u),t.guid&&(e.guid=o.guid=o.guid||t.guid++),e},t.debounce=function(e,t,i){return i===u?a(e,t,!1):a(e,i,!1!==t)}}(this),window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}),window.requestIdleCallback||(window.requestIdleCallback=function(e){setTimeout(e)}),jQuery(function(r){if(0<jQuery("select.wp-pageselect").length&&void 0!==jQuery("select.wp-pageselect").selectize)var t=jQuery("select.wp-pageselect").selectize({placeholder:"Search a post/page/category ID or name...",optgroupField:"class",labelField:"name",searchField:["name"],optgroups:window.abtf_pagesearch_optgroups,onType:function(e){/^http(s)?:\/\/[^\/]+\//.test(e)&&t[0].selectize.setTextboxValue(e.replace(/^http(s)?:\/\/[^\/]+\//,"/"))},load:function(e,t){if(!e.length)return t();jQuery.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"abtf_page_search",query:e,maxresults:10},error:function(){t()},success:function(e){t(e)}})}});0<jQuery("#fullcsspages").length&&void 0!==jQuery("#fullcsspages").selectize&&(jQuery("#fullcsspages_dl").on("click",function(){var e=jQuery("#fullcsspages").val();""!==e?(/\?/.test(e)?e+="&":e+="?",document.location.href=e+"extract-css="+jQuery("#fullcsspages_dl").attr("rel")+"&output=download"):alert("Select a page...")}),jQuery("#fullcsspages_print").on("click",function(){var e=jQuery("#fullcsspages").val();""!==e?(/\?/.test(e)?e+="&":e+="?",window.open(e+"extract-css="+jQuery("#fullcsspages_print").attr("rel")+"&output=print")):alert("Select a page...")})),0<jQuery("#criticalcss-test-pages").length&&void 0!==jQuery("#criticalcss-test-pages").selectize&&(jQuery("#splitview").on("click",function(){var e=jQuery("#criticalcss-test-pages").val();""!==e?(/\?/.test(e)?e+="&":e+="?",window.open(e+"critical-css-editor=1")):alert("Select a page...")}),jQuery("#editorview").on("click",function(){var e=jQuery("#criticalcss-test-pages").val();""!==e?(/\?/.test(e)?e+="&":e+="?",window.open(e+"critical-css-editor=1#editor")):alert("Select a page...")}),jQuery("#fullview").on("click",function(){var e=jQuery("#criticalcss-test-pages").val();""!==e?(/\?/.test(e)?e+="&":e+="?",window.open(e+"critical-css-view=1")):alert("Select a page...")})),r(".clickselect").on("click",function(){if(document.selection)(e=document.body.createTextRange()).moveToElementText(r(this)[0]),e.select();else if(window.getSelection){var e;(e=document.createRange()).selectNode(r(this)[0]),window.getSelection().addRange(e)}}),r("[data-example]").each(function(e,t){r(t).on("click",function(e){var t=r("#"+r(this).data("example"));if(0<t.length){var i=t.data("example-text"),a=t.html(),n=r(this).data("example-html");"string"!=typeof n&&(n=JSON.stringify(n)),t.html(n),t.data("example-text",r(this).html()),r(this).html(i),r(this).data("example-html",a)}})})}),jQuery(function(){0!==jQuery(".abtf-bt-builder").length&&(jQuery('.abtf-bt-builder input[name="taskname"]').on("keyup change",function(){var e=jQuery(this).val();if(""===e&&(e="task-name"),/^critical-/.test(e)||(e="critical-",jQuery(this).val(e)),!/^[a-z0-9\-]+$/.test(e)){var t=new RegExp("[^a-z0-9-]+","g");e=e.replace(t,""),jQuery(this).val(e)}50<e.length&&(e=e.substring(0,50),jQuery(this).val(e),alert("Maximum name length is 50")),jQuery(".gulp-task-name").html(e)}),jQuery('.abtf-bt-builder input[name="taskname"]').on("blur",function(){var e=jQuery(this).val();if("critical-"===e)return e="",jQuery(this).val(e),void jQuery(".gulp-task-name").html("task-name");var t=e.replace(/^-+/g,"").replace(/-+$/g,"");e!==t&&(jQuery(this).val(t),jQuery(".gulp-task-name").html(t))}),jQuery('.abtf-bt-builder input[name="taskname"]').on("focus",function(){""===jQuery(this).val()&&jQuery(this).val("critical-")}),jQuery('.abtf-bt-builder input[name="taskname"]').on("click",function(){jQuery(this).blur().focus().val(jQuery(this).val())}))}),jQuery(function(){0<jQuery("#addcriticalcss-form").length&&(jQuery("#addcriticalcss").on("click",function(){if(!jQuery("#addcriticalcss-form").is(":visible")){var e=jQuery("#addcc_conditions");e.data("conditions-loaded")||(e.data("conditions-loaded",1),window.loadConditionSelect(jQuery("#addcc_conditions")))}jQuery("#addcriticalcss-form").toggle()}),jQuery("#addcc_save").on("click",function(){var e=jQuery.trim(jQuery("#addcc_name").val()),t=jQuery("#addcc_conditions").val();if(""===e)return alert("Enter a name (admin reference)..."),void jQuery("#addcc_name").focus();if(!/^[a-zA-Z0-9\-\_ ]+$/.test(e))return alert("The name contains invalid characters."),void jQuery("#addcc_name").focus();var i,a=jQuery("<form />");a.attr("method","post"),a.attr("action",jQuery("#abtf_settings_form").data("addccss")),(i=jQuery('<input type="hidden" name="name" />')).val(e),a.append(i),(i=jQuery('<input type="hidden" name="conditions" />')).val(t),a.append(i),(i=jQuery('<input type="hidden" name="_wpnonce" />')).val(jQuery("#_wpnonce").val()),a.append(i),jQuery("body").append(a),jQuery(a).submit()}))}),jQuery(function(){var a=0<jQuery("#abtfcss").length&&1===parseInt(jQuery("#abtfcss").data("advanced")),t={};if(a){var n=function(e){0!==jQuery("#ccss_editor_"+e+" .abtfcss").length&&(t[e]=CodeMirror.fromTextArea(jQuery("#ccss_editor_"+e+" .abtfcss")[0],{lineWrapping:!0,lineNumbers:!0,gutters:["CodeMirror-lint-markers"],lint:!0}),t[e].on("change",function(){window.inputChange=!0}),jQuery("#ccss_editor_"+e).closest(".menu-item").removeClass("menu-item-edit-inactive").addClass("menu-item-edit-active"),i())},r=function(e){t[e]&&(t[e].save(),t[e].toTextArea(),t[e]=!1,jQuery("#ccss_editor_"+e).closest(".menu-item").addClass("menu-item-edit-inactive").removeClass("menu-item-edit-active"))},i=function(){var e=jQuery(".CodeMirror").closest(".inside").outerWidth()-26;jQuery(".CodeMirror").css({width:e+"px"})};jQuery(window).resize(function(){for(editor_id in i(),t)t.hasOwnProperty(editor_id)||t[editor_id]&&t[editor_id].refresh()})}if(window.loadConditionSelect=function(e){if(0!==jQuery(e).length){jQuery(e).val("");var t,i,a=jQuery(e).selectize({options:[],searchField:["title","titlelong","value"],persist:!0,optgroupField:"optgroup",placeholder:"Select one or more conditions. Type the name of a page or post to search (autocomplete)...",delimiter:"|==abtf==|",render:{optgroup_header:function(e,t){return'<div class="optgroup-header "><span class="'+e.class+'">&nbsp;</span>'+t(e.title)+"</div>"},option:function(e,t){return'<div class="opt"><span class="title"><span class="name">'+t(e.titlelong?e.titlelong:e.title)+'</span><span class="desc">&nbsp;&nbsp;'+t(e.value)+"</span></span></div>"},item:function(e,t){return'<div class="'+e.class+'" title="'+t(e.value)+(e.titlelong?" - "+t(e.titlelong):"")+'"><span class="name">'+t(e.title)+"</span></div>"}},createFilter:function(e){return!!new RegExp("^filter:([a-z0-9-_]+(:.*)?)?$","i").test(e)&&e},create:function(e){return!!new RegExp("^filter:[a-z0-9-_]+(:.*)?$","i").test(e)&&{value:e,title:e,optgroup:"filter",class:"filter"}},load:function(e,t){if(!e.length)return t();jQuery.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"abtf_condition_search",query:e,maxresults:10},error:function(){t()},success:function(e){t(e)}})},plugins:["remove_button"]});for(i in window.conditional_options[1])window.conditional_options[1].hasOwnProperty(i)&&a[0].selectize.addOptionGroup(i,window.conditional_options[1][i]);for(var n=0;n<window.conditional_options[0].length;n++)t=window.conditional_options[0][n],a[0].selectize.addOption(t);var r=jQuery(e).data("conditions");if(r)for(n=0;n<r.length;n++)void 0===a[0].selectize.options[r[n].value]&&a[0].selectize.addOption(r[n]),a[0].selectize.addItem(r[n].value,!0)}},window.unloadConditionSelect=function(e){if(0!==jQuery(e).length){var t=jQuery(e)[0].selectize,i=t.getValue().split(t.settings.delimiter),a=[];if(i instanceof Array)for(var n=["value","title","optgroup","class"],r=n.length,o=i.length,s=0;s<o;s++)if(t.options[i[s]]){for(var c=t.options[i[s]],l={},u=0;u<r;u++)void 0!==c[n[u]]&&(l[n[u]]=c[n[u]]);a.push(l)}jQuery(e).data("conditions",a),t.destroy()}},0<jQuery(".criticalcss-edit-header").length){var o={},s=function(e,t){var i=jQuery(e).attr("rel"),a=parseInt(jQuery("#ccss_editor_"+i).data("toggle-start"));return 1===a?1===t&&(o[i]&&clearTimeout(o[i]),jQuery("#ccss_editor_"+i).data("toggle-start",""),jQuery(e).on("click",c),jQuery(".loading-editor",e).hide()):0===t&&(jQuery("#ccss_editor_"+i).is(":visible")||jQuery(".loading-editor",e).show(),jQuery("#ccss_editor_"+i).data("toggle-start",1),jQuery(e).off("click",c),o[i]=setTimeout(function(){s(e,1)},3e3)),a},c=function(e){var t=jQuery(this),i=jQuery(this).attr("rel");if(!(1<e.originalEvent.detail)){if(e.preventDefault(),e.stopPropagation(),1===s(t,0))return!1;setTimeout(function(){window.requestAnimationFrame(function(){jQuery("#ccss_editor_"+i).is(":visible")?(a&&r(i),unloadConditionSelect(jQuery('.conditions input[rel="conditions"]',jQuery("#ccss_editor_"+i))),jQuery("#ccss_editor_"+i).hide()):(jQuery("#ccss_editor_"+i).show(),a&&n(i),loadConditionSelect(jQuery('.conditions input[rel="conditions"]',jQuery("#ccss_editor_"+i)))),s(t,1)})},10)}};jQuery(".criticalcss-edit-header").on("click",c),jQuery(".criticalcss-edit-header").each(function(e,t){if(0<jQuery(".item-delete",jQuery(t)).length){var a=jQuery(t).data("file");jQuery(".item-delete",jQuery(t)).on("click",function(e){if(e.preventDefault(),e.stopPropagation(),confirm(jQuery(this).data("confirm"),!0)){var t,i=jQuery("<form />");i.attr("method","post"),i.attr("action",jQuery("#abtf_settings_form").data("delccss")),(t=jQuery('<input type="hidden" name="file" />')).val(a),i.append(t),(t=jQuery('<input type="hidden" name="_wpnonce" />')).val(jQuery("#_wpnonce").val()),i.append(t),jQuery("body").append(i),jQuery(i).submit()}})}})}0<jQuery("#abtfcss").length&&1===parseInt(jQuery("#abtfcss").data("advanced"))&&jQuery(".ccss_editor").each(function(e,t){jQuery(t).is(":visible")&&a&&n(jQuery(".criticalcss-edit-header",jQuery(t).parents(".menu-item").first()).attr("rel"))})});